<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Document Viewer</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Marked.js library to convert Markdown to HTML -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* Basic styling for the markdown content to improve readability */
        .markdown-body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
            line-height: 1.6;
            padding: 2rem;
        }
        .markdown-body h1, .markdown-body h2, .markdown-body h3 {
            border-bottom: 1px solid #eaecef;
            padding-bottom: 0.3em;
            margin-top: 24px;
            margin-bottom: 16px;
        }
        .markdown-body code {
            background-color: #f6f8fa;
            border-radius: 6px;
            padding: 0.2em 0.4em;
            font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        }
        .markdown-body pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            padding: 16px;
            overflow: auto;
        }
        .markdown-body blockquote {
            border-left: 0.25em solid #dfe2e5;
            padding: 0 1em;
            color: #6a737d;
        }
        .markdown-body a {
            color: #0366d6;
            text-decoration: none;
        }
        .markdown-body a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200">

    <div class="container mx-auto max-w-4xl bg-white dark:bg-gray-800 rounded-lg shadow-xl my-4 sm:my-8">
        <div id="content" class="markdown-body">
            <div id="loader" class="text-center p-12">
                <h1 class="text-2xl font-semibold">Loading document...</h1>
                <p class="mt-2 text-gray-500">Please wait a moment.</p>
            </div>
        </div>
    </div>

    <script>
        // This is the main script that fetches and renders the Markdown file.
        window.onload = async () => {
            const contentDiv = document.getElementById('content');
            
            try {
                // 1. Get the markdown file path from the URL query parameter called 'file'.
                const urlParams = new URLSearchParams(window.location.search);
                const mdFile = urlParams.get('file');
                let markdownText = '';

                if (mdFile) {
                    // If a file is specified in the URL, fetch it.
                    document.title = mdFile; // Set document title to filename
                    const response = await fetch(mdFile);

                    if (!response.ok) {
                        throw new Error(`Could not load the file '${mdFile}'. Status: ${response.status}`);
                    }

                    markdownText = await response.text();
                } else {
                    // If no file is specified, show a default welcome/instruction message.
                    document.title = "Markdown Viewer Instructions";
                    markdownText = `
# Welcome to the Markdown Viewer!

This is a default document because no file was specified in the URL.

---

## How to use this viewer:

1.  Upload this \`markdown_viewer.html\` file to your website.
2.  Upload your Markdown files (e.g., \`mydoc.md\`) to the same directory.
3.  To view your document, add a query parameter to the URL like this:

    **\`.../markdown_viewer.html?file=mydoc.md\`**

### Features

* Renders headings, lists, code blocks, and more.
* Styled with Tailwind CSS for a clean look.
* Uses the [Marked.js](https://marked.js.org/) library for conversion.

> This is a blockquote, useful for highlighting important information.

\`\`\`javascript
// Example code block
function greet() {
    console.log("Hello, world!");
}
\`\`\`
`;
                }

                // 2. Convert the Markdown text to HTML using the marked.js library.
                const htmlContent = marked.parse(markdownText);

                // 3. Display the resulting HTML in our content div.
                contentDiv.innerHTML = htmlContent;

            } catch (error) {
                console.error('Error loading markdown file:', error);
                // Display a user-friendly error message.
                contentDiv.innerHTML = `
                    <div class="text-center p-12 text-red-600">
                        <h1 class="text-2xl font-semibold">Failed to Load Document</h1>
                        <p class="mt-2 text-gray-500 dark:text-gray-400">${error.message}</p>
                        <p class="mt-4">Please check the file name in the URL and make sure the file exists and is accessible.</p>
                    </div>
                `;
            }
        };
    </script>

</body>
</html>

